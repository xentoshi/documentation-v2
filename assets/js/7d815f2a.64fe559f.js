"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9048],{2272:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var n=i(5893),o=i(1151);const a={title:"Optimisations",slug:"VNtx-optimisations",createdAt:"Thu Aug 25 2022 01:24:07 GMT+0000 (Coordinated Universal Time)",updatedAt:"Tue Feb 21 2023 11:51:42 GMT+0000 (Coordinated Universal Time)"},s=void 0,r={id:"Drift Protocol v2 Docs/Optimisations",title:"Optimisations",description:"Drift Protocol's vAMM (DAMM) acts as the designated market maker to provide a guaranteed liquidity source for traders. To overcome latency arbitrage, adverse selection and toxic flow, a number of optimisations were made within the protocol while following particular constraints such as maximum allowable spread and minimum liquidity depth.&#x20;",source:"@site/docs/Drift Protocol v2 Docs/Optimisations.md",sourceDirName:"Drift Protocol v2 Docs",slug:"/Drift Protocol v2 Docs/VNtx-optimisations",permalink:"/documentation-v2/docs/Drift Protocol v2 Docs/VNtx-optimisations",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Drift Protocol v2 Docs/Optimisations.md",tags:[],version:"current",frontMatter:{title:"Optimisations",slug:"VNtx-optimisations",createdAt:"Thu Aug 25 2022 01:24:07 GMT+0000 (Coordinated Universal Time)",updatedAt:"Tue Feb 21 2023 11:51:42 GMT+0000 (Coordinated Universal Time)"},sidebar:"tutorialSidebar",previous:{title:"MetaMask Set Up",permalink:"/documentation-v2/docs/Drift Protocol v2 Docs/pFx6-c"},next:{title:"Oracles",permalink:"/documentation-v2/docs/Drift Protocol v2 Docs/22EZ-oracles"}},l={},c=[{value:"Auction Process",id:"auction-process",level:3},{value:"Concentration Factor",id:"concentration-factor",level:3},{value:"Formulaic K",id:"formulaic-k",level:3},{value:"Participation in the JIT Auction",id:"participation-in-the-jit-auction",level:3},{value:"P&amp;L Settlement",id:"pl-settlement",level:3},{value:"Terminal State Consideration",id:"terminal-state-consideration",level:3}];function d(e){const t={a:"a",div:"div",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"Drift Protocol's vAMM (DAMM) acts as the designated market maker to provide a guaranteed liquidity source for traders. To overcome latency arbitrage, adverse selection and toxic flow, a number of optimisations were made within the protocol while following particular constraints such as maximum allowable spread and minimum liquidity depth. "}),"\n",(0,n.jsx)(t.div,{children:(0,n.jsx)(t.p,{children:"Drift's AMM essentially bootstraps liquidity in a perpetuals market and offers a competitive lower bound as opposed to relying fully on external liquidity providers which can freely come and go."})}),"\n",(0,n.jsx)(t.h3,{id:"auction-process",children:"Auction Process"}),"\n",(0,n.jsx)(t.p,{children:"The auction process itself acts as a speedbump against latency arbitrage of the oracle and the vAMM. This helps to reduce the adverse selection faced on-chain. "}),"\n",(0,n.jsx)(t.h3,{id:"concentration-factor",children:"Concentration Factor"}),"\n",(0,n.jsx)(t.p,{children:"The size of k (the constant product invariant) determines the depth of liquidity. By increasing k by a factor of <X> but making the max/min base reserves tighter, the AMM can provide the same amount of bid and ask liquidity but it is now concentrated with a tighter price range."}),"\n",(0,n.jsx)(t.h3,{id:"formulaic-k",children:"Formulaic K"}),"\n",(0,n.jsx)(t.p,{children:"After every funding rate update, if the net revenue (in terminal) increased over the hour, the vAMM will utilize the funding received to increase k (hence the depth of liquidity provided). Otherwise, if the vAMM had to pay funding over the previous hour, a portion of the payment will be utilized to reduce k (decrease liquidity offering). These updates have maximum update amounts of .1% but are used to converge toward an optimal k over time."}),"\n",(0,n.jsx)(t.h3,{id:"participation-in-the-jit-auction",children:"Participation in the JIT Auction"}),"\n",(0,n.jsx)(t.p,{children:"Just as market makers provide active liquidity through the JIT auction process, the DAMM may also opt to participate as well in order to reduce inventory. "}),"\n",(0,n.jsx)(t.h3,{id:"pl-settlement",children:"P&L Settlement"}),"\n",(0,n.jsx)(t.p,{children:"Due to: "}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Potential market imbalances;"}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Live-oracle based pricing; and "}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Maximum allowable spread set by the DAMM, "}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The way unrealised P&L users can lock in from entering and exiting a trade against the DAMM is technically unbounded (e.g. if BTC goes toward infinity)."}),"\n",(0,n.jsx)(t.p,{children:"However, whilst a user can achieve this unrealised gain, it is important to note that an offsetting loss (or sufficient fees collected) is necessary before the unrealised gain can be settled in full and withdrawable as collateral."}),"\n",(0,n.jsxs)(t.p,{children:["Until the P&L pool is replenished by offsetting losses, winners may* be offered discounted margin on unrealised gains. Winners will have the ability to withdraw their portion from the P&L settlement pool as it increases. Read more about the settlement mechanism in ",(0,n.jsx)(t.a,{href:"/documentation-v2/docs/Drift%20Protocol%20v2%20Docs/CImq-pandl",children:"P&L"}),". "]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"*"}),": If the unrealised P&L imbalance exceeds its per-market threshold, those unrealised gains may be discounted by the margining system (initial, not maintenance) to prevent large borrows against it. This initial margin discounting would only impact new positions being opened and would not affect a user's liquidation threshold."]}),"\n",(0,n.jsxs)(t.p,{children:["These rules are systemitised and can be read more under the Margin subheading in ",(0,n.jsx)(t.a,{href:"/documentation-v2/docs/Drift%20Protocol%20v2%20Docs/NtFm-cross-collateral-deposits",children:"Cross-Collateral Deposits"}),". "]}),"\n",(0,n.jsx)(t.h3,{id:"terminal-state-consideration",children:"Terminal State Consideration"}),"\n",(0,n.jsx)(t.p,{children:"If the inventory on the vAMM is 0, all the repeg and k change operations have no terminal state costs. "}),"\n",(0,n.jsx)(t.p,{children:"Even so, the vAMM is still fully aware of the remaining position imbalance within the market and makes decisions on its spread size and liquidity depth based on that awareness (while following its constraints as a designated market maker). "})]})}function u(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>r,a:()=>s});var n=i(7294);const o={},a=n.createContext(o);function s(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);